path = "testdata";filename = "";list=dir(path);list(1) = [];list(1) = [];for i=1:length(list)  %i=1:length(list)!!Subject 2만 하려고 한거라서 바꿔줘야 함    filename = list(i).name;        loadfilename = path+"\"+filename;    data = xlsread(loadfilename);    % 변수    bands =  [10 12;0.2 30; 9 13];         %델타파 시도[10 12;0.2 30; 9 13]    %4~8제거: [4 8;0.5 30; 3 9]    %4~12제거:  [4 12;0.5 30; 3 13]        sampling_freq = 250;    %[10 12자를 위치;8 30 원하는 전체범위; bandstop잘라낼부분]        fprintf("%s 파일 시작\n",filename);    for idx=0:length(data)        if (idx+1)*2000 >length(data)            break;        end                fprintf("%d 번째 trial\n",idx);                trial_x = data(idx*2000+1:(idx+1)*2000,:);        [W, A, lambda, C_s, X_ssd] = ssd(trial_x, bands, sampling_freq, [], []);    %     엑셀 파일에 1명(왼쪽, 오른쪽 각각) 저장        filename = erase(filename,".csv");        savefilename = "SSD_data/ssd-"+filename+".xlsx";        xlRange = "A"+int2str(idx*2000+1)+":C"+int2str((idx+1)*2000);        fprintf("%s\n",xlRange);        writematrix(trial_x,savefilename,'Sheet',1,'Range',xlRange);    endend